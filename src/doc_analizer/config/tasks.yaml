extract_documents:
  description: >
    Ingest every supplied document from {file_paths} using LandingAI ADE and deliver a
    lossless, structured JSON payload. For each file capture text spans, key-value
    pairs, tables (with headers, units, footnotes), attachments, and provenance
    metadata (filename, page, section anchors). Validate OCR confidence and log
    unreadable or low-confidence content in an issues list. Normalize monetary
    values to their stated currency and explicitly note any conversions performed.
  expected_output: >
    "JSON array; each element is an object with keys: metadata{filename,pages,currency_code},
    key_value_pairs[{key,value,unit,page,locator}], tables[{title,page,locator,headers,rows,units,footnotes}],
    narratives[{text,page,locator}], attachments[{type,page,description}], issues[{type,message,page,locator,confidence}].
    Numeric fidelity and currency symbols preserved; unknown values are null with an issues[] entry."
  agent: document_extractor


analyze_financial_data:
  description: >
    Convert {{ extract_documents.output }} into the requested {analysis_type} deliverable. Begin by
    validating data completeness against required statements and metrics. Compute
    profitability, liquidity, leverage, efficiency, cash coverage, and growth ratios,
    noting assumptions and adjustments. Evaluate covenant compliance, risk signals,
    and forward-looking scenarios (base, downside, upside). Summarize the material
    drivers impacting stakeholders and flag data gaps that require clarification.
  expected_output: >
    "Structured JSON with sections: executive_summary, metrics (each with name, formula, value, unit, interpretation, source),
    risk_assessment, scenario_analysis (base, downside, upside), recommendations (with priority), data_gaps, pushover_summary (<=500 chars)."
  agent: financial_analyst
  output_file: output/{analysis_type}_analyze.md
  

generate_report:
  description: >
    Transform {{ analyze_financial_data.output }} into a stakeholder-ready report aligned with the provided
    format guidelines. Translate each analysis section into clear prose, highlight
    top decisions, embed accessible tables or charts placeholders for key metrics,
    reference original document sources, and elevate urgent risks or opportunities
    with call-outs. Ensure the narrative flows logically from executive summary to
    appendix and that accessibility best practices are applied.
    
  IMPORTANT: After generating the complete report, you MUST call pushover_notifier using
    the pushover_summary produced by the analyst.
  expected_output: >
    "Markdown document containing Executive Summary, Company Snapshot, Financial Highlights, 
    Risk & Compliance, Scenario Analysis, Recommendations, Appendix with cited sources.
    Additionally, a Pushover notification must be sent with the executive summary and key findings."
  agent: report_generator
  output_file: output/{analysis_type}_report.md
